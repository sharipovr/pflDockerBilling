–•–æ—Ä–æ—à–æ, —Ç–æ–≥–¥–∞ —É—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ PostgreSQL —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω–µ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, —Ç–µ–±–µ –Ω–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å PostgreSQL –≤ docker-compose.

**–í–æ—Ç —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥** —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥ —Ç–≤–æ—é —Å–∏—Ç—É–∞—Ü–∏—é:

---

## üîß –®–∞–≥ 1: –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Dockerfile –¥–ª—è Golang-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

–§–∞–π–ª: `backend/Dockerfile`

```dockerfile
FROM golang:1.22-alpine

WORKDIR /app

COPY go.mod go.sum ./
RUN go mod download

COPY . .

RUN go build -o pflDockerBilling ./cmd/main.go

EXPOSE 8080

CMD ["./pflDockerBilling"]
```

---

## üîß –®–∞–≥ 2: –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π docker-compose.yml (—Ç–æ–ª—å–∫–æ –±—ç–∫–µ–Ω–¥)

–§–∞–π–ª: `docker-compose.yml` (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)

```yaml
version: '3.9'

services:
  backend:
    build: ./backend
    container_name: billing_backend
    ports:
      - "8080:8080"
    environment:
      DB_HOST: host.docker.internal
      DB_USER: postgres
      DB_PASSWORD: postgres
      DB_NAME: dockerbilling
      DB_PORT: 5432
```

**–ü–æ—è—Å–Ω–µ–Ω–∏–µ:**
`host.docker.internal` ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–º–æ–∂–µ—Ç –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É PostgreSQL, —Ä–∞–±–æ—Ç–∞—é—â–µ–º—É –Ω–∞ —Ç–≤–æ—ë–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –≤–Ω–µ Docker.

---

## üîß –®–∞–≥ 3: –ü–æ–ø—Ä–∞–≤—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –≤ —Ñ–∞–π–ª–µ storage.go

–û–±–Ω–æ–≤–∏ —Ñ–∞–π–ª: `backend/storage/storage.go`

```go
package storage

import (
	"fmt"
	"log"
	"os"

	"gorm.io/driver/postgres"
	"gorm.io/gorm"
	"yourusername/pflDockerBilling/models"
)

var DB *gorm.DB

func Init() {
	dsn := fmt.Sprintf(
		"host=%s user=%s password=%s dbname=%s port=%s sslmode=disable",
		os.Getenv("DB_HOST"),
		os.Getenv("DB_USER"),
		os.Getenv("DB_PASSWORD"),
		os.Getenv("DB_NAME"),
		os.Getenv("DB_PORT"),
	)

	db, err := gorm.Open(postgres.Open(dsn), &gorm.Config{})
	if err != nil {
		log.Fatal("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î: ", err)
	}

	db.AutoMigrate(&models.User{}, &models.Subscription{})
	DB = db
}
```

---

## üîß –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –±—ç–∫–µ–Ω–¥–æ–º

–ó–∞–ø—É—Å—Ç–∏ –±—ç–∫–µ–Ω–¥, –ø–æ–¥–∫–ª—é—á–∞—é—â–∏–π—Å—è –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î:

```bash
docker-compose up --build
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—å API-–∑–∞–ø—Ä–æ—Å–æ–º:

```bash
curl http://localhost:8080/api/users
```

* –ï—Å–ª–∏ –≤—Å—ë –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø–æ–ª—É—á–∏—à—å JSON-–æ—Ç–≤–µ—Ç (–ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç).

---

## üìå –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

* –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Ç–≤–æ–π –ª–æ–∫–∞–ª—å–Ω—ã–π PostgreSQL —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (Docker –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å).
* –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–ø—Ä–∞–≤—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PostgreSQL (—Ñ–∞–π–ª `pg_hba.conf`) –∏–ª–∏ —É–±–µ–¥–∏—Å—å, —á—Ç–æ –æ–Ω —Å–ª—É—à–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–µ —Ç–æ–ª—å–∫–æ —Å localhost, –Ω–æ –∏ —Å Docker (`postgresql.conf` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä `listen_addresses = '*'`).

**–†–µ—Å—Ç–∞—Ä—Ç PostgreSQL –ø–æ—Å–ª–µ –ø—Ä–∞–≤–æ–∫**:

```bash
sudo service postgresql restart
```

---

–¢–µ–ø–µ—Ä—å —É—á—Ç–µ–Ω—ã —Ç–≤–æ–∏ —Ç–µ–∫—É—â–∏–µ —É—Å–ª–æ–≤–∏—è: Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Golang-–±—ç–∫–µ–Ω–¥–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ –∏–º–µ—é—â–∏–π—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–π PostgreSQL —Å–µ—Ä–≤–µ—Ä.
